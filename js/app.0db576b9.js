(function(t){function e(e){for(var i,a,s=e[0],c=e[1],u=e[2],p=0,d=[];p<s.length;p++)a=s[p],r[a]&&d.push(r[a][0]),r[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(i=!1)}i&&(o.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},r={app:0},o=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/bandit-commercejs-vue-demo/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"App ph2 pv4"},[t.order?n("div",{staticClass:"mw7 center"},[n("h2",{staticClass:"tracked ttu green"},[t._v("\n      Thank you for shopping!\n    ")]),n("h4",{staticClass:"tracked ttu gray flex justify-between"},[t._v("\n      Your order number is #"+t._s(t.order.id)+"\n    ")])]):t._e(),t.checkout?n("checkout",{attrs:{checkout:t.checkout,commerce:t.commerce},on:{"capture-order":t.captureOrder,"cancel-checkout":t.cancelCheckout}}):n("div",[n("cart",{attrs:{cart:t.cart},on:{"remove-item-from-cart":t.removeProductFromCart,"create-checkout":t.createCheckout}}),n("div",{staticClass:"products-container mw7 center cf"},[n("h2",{staticClass:"tracked ttu gray"},[t._v("\n        All Products\n      ")]),t.products.length?n("div",t._l(t.products,function(e){return n("product-item",{key:e.id,attrs:{product:e},on:{"add-product-to-cart":t.addProductToCart}})}),1):n("p",[t._v("There no products available right now")])]),n("div",{staticClass:"products-container products-recommended mw7 center cf"},[n("h2",{staticClass:"tracked ttu gray"},[t._v("\n        Recommended products\n      ")]),t.recProducts.length?n("div",t._l(t.recProducts,function(e){return n("product-item",{key:e.id,attrs:{product:e},on:{"add-product-to-cart":t.addProductToCart}})}),1):n("p",[t._v("There no products available right now")])])],1)],1)},o=[],a=(n("6c7b"),n("bd86")),s=n("cebc"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"products-container__product fl w-third pa1 flex flex-column justify-center"},[n("div",{staticClass:"aspect-ratio aspect-ratio--5x8 bg-black-50",style:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",backgroundImage:"url("+t.product.media.source+")"}}),n("p",{staticClass:"tracked f7 flex justify-between items-center"},[t._v("\n   "+t._s(t.product.name)+"\n   "),n("span",[t._v("\n   "+t._s(t.product.price.formatted_with_code)+"\n   ")])]),n("button",{staticClass:"dim b1 b--mid-gray outline-0 pointer pa2",attrs:{disabled:t.product.is.sold_out},on:{click:function(e){return t.$emit("add-product-to-cart",t.product.id)}}},[t._v("\n   "+t._s(t.product.is.sold_out?"Sold Out":"Add to Cart")+"\n  ")])])},u=[],l={name:"ProductItem",props:{product:{type:Object,required:!0}}},p=l,d=n("2877"),m=Object(d["a"])(p,c,u,!1,null,null,null),h=m.exports,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mw7 center"},[t.cart?n("div",{staticClass:"cart-container center"},[n("h2",{staticClass:"tracked ttu gray flex justify-between"},[t._v("\n        Cart ("+t._s(t.cart.total_items)+")\n        "),n("span",{staticClass:"flex flex-column f7"},[n("span",[t._v("\n            subtotal: $"+t._s(t.cart.subtotal.formatted_with_code)+"\n          ")])])]),t.cart.total_items>0?n("ul",{staticClass:"w-100 list-reset ma0 pv0 ph4"},t._l(t.cart.line_items,function(e){return n("line-item",{key:e.id,attrs:{item:e},on:{"remove-item-from-cart":function(e){return t.$emit("remove-item-from-cart",e)}}})}),1):n("p",{staticClass:"f7 tracked"},[t._v("Your cart is empty")]),n("button",{staticClass:"dim b1 outline-0 pointer pa2 mt2 db w-100",class:[0===t.cart.total_items?"b--light-gray":"b--mid-gray"],attrs:{disabled:0===t.cart.total_items},on:{click:function(e){return t.$emit("create-checkout")}}},[t._v("\n        Checkout\n      ")])]):n("p",{staticClass:"center"},[t._v("\n    Loading Cart...\n  ")])])},f=[],g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cart-container__line-item w-100 flex items-center justify-between pb2"},[n("div",{staticClass:"w-auto pr1"},[n("p",{staticClass:"tracked ttc f7"},[t._v("\n      "+t._s(t.item.name+" - "+t.item.quantity+" "+t.item.line_total.formatted_with_code)+"\n    ")])]),n("button",{staticClass:"dim b1 b--mid-gray outline-0 pointer pa2",on:{click:function(e){return t.$emit("remove-item-from-cart",t.item.id)}}},[t._v("\n    Remove from Cart\n  ")])])},b=[],_={name:"LineItem",props:["item"]},y=_,C=Object(d["a"])(y,g,b,!1,null,null,null),x=C.exports,k={name:"cart",props:["cart"],components:{LineItem:x}},w=k,P=Object(d["a"])(w,v,f,!1,null,null,null),O=P.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"checkout-container mw7 center pb4"},[n("h2",{staticClass:"tracked ttu gray flex justify-between"},[t._v("\n    Checkout\n  ")]),n("ul",{staticClass:"w-100 list-reset ma0 pv0 ph4"},t._l(t.checkout.live.line_items,function(t){return n("li",{key:t.id},[n("checkout-item",{attrs:{item:t}})],1)}),0),n("form",{on:{submit:function(e){return e.preventDefault(),t.captureOrder(e)}}},[n("h4",{staticClass:"tracked ttu gray flex justify-between"},[t._v("\n      Customer Details\n    ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.customerFirstName,expression:"customerFirstName"}],staticClass:"db mb1",attrs:{type:"text",name:"customerFirstName",placeholder:"First Name"},domProps:{value:t.customerFirstName},on:{input:function(e){e.target.composing||(t.customerFirstName=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.customerLastName,expression:"customerLastName"}],staticClass:"db mb1",attrs:{type:"text",name:"customerLastName",placeholder:"Last Name"},domProps:{value:t.customerLastName},on:{input:function(e){e.target.composing||(t.customerLastName=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.customerEmail,expression:"customerEmail"}],staticClass:"db mb1",attrs:{type:"email",name:"customerEmail",placeholder:"Email"},domProps:{value:t.customerEmail},on:{input:function(e){e.target.composing||(t.customerEmail=e.target.value)}}}),n("h4",{staticClass:"tracked ttu gray flex justify-between"},[t._v("\n      shipping address\n    ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.shippingFullName,expression:"shippingFullName"}],staticClass:"db mb1",attrs:{type:"text",name:"shippingFullName",placeholder:"Name"},domProps:{value:t.shippingFullName},on:{input:function(e){e.target.composing||(t.shippingFullName=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.streetAddress,expression:"streetAddress"}],staticClass:"db mb1",attrs:{type:"text",name:"streetAddress",placeholder:"Street Address"},domProps:{value:t.streetAddress},on:{input:function(e){e.target.composing||(t.streetAddress=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.city,expression:"city"}],staticClass:"db mb1",attrs:{type:"text",name:"city",placeholder:"City"},domProps:{value:t.city},on:{input:function(e){e.target.composing||(t.city=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.postalZipcode,expression:"postalZipcode"}],staticClass:"db mb1",attrs:{type:"text",name:"postalZipcode",placeholder:"Postal/Zip Code"},domProps:{value:t.postalZipcode},on:{input:function(e){e.target.composing||(t.postalZipcode=e.target.value)}}}),n("select",{directives:[{name:"model",rawName:"v-model",value:t.country,expression:"country"}],staticClass:"db mb2",attrs:{name:"country"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.country=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"",disabled:""}},[t._v("Country")]),t._l(t.countries,function(e,i,r){return n("option",{key:r,domProps:{value:i}},[t._v(t._s(e))])})],2),n("select",{directives:[{name:"model",rawName:"v-model",value:t.provinceRegionState,expression:"provinceRegionState"}],staticClass:"db mb2",attrs:{name:"provinceRegionState",placeholder:"Province/Region/State"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.provinceRegionState=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"",disabled:""}},[t._v("Province/Region/State")]),t._l(t.subdivisions,function(e,i,r){return n("option",{key:i+r,domProps:{value:i}},[t._v(t._s(e))])})],2),n("h4",{staticClass:"tracked ttu gray flex justify-between"},[t._v("\n      choose a shipping method\n    ")]),t.shippingOptions.length>0?n("select",{directives:[{name:"model",rawName:"v-model",value:t.shippingOption,expression:"shippingOption"}],staticClass:"db mb2",attrs:{name:"shippingOption"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.shippingOption=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"",disabled:""}},[t._v("Choose a shipping method")]),t._l(t.shippingOptions,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.description+" - $"+e.price.formatted_with_code))])})],2):n("p",[t._v("\n      There are no shipping options available for the selected country\n    ")]),n("h4",{staticClass:"tracked ttu gray flex justify-between"},[t._v("\n      Payment\n    ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.cardNumber,expression:"cardNumber"}],staticClass:"db mb1",attrs:{type:"text",name:"cardNumber",placeholder:"Card Number"},domProps:{value:t.cardNumber},on:{input:function(e){e.target.composing||(t.cardNumber=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.expMonth,expression:"expMonth"}],staticClass:"db mb1",attrs:{type:"text",name:"expMonth",placeholder:"Exp Month"},domProps:{value:t.expMonth},on:{input:function(e){e.target.composing||(t.expMonth=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.expYear,expression:"expYear"}],staticClass:"db mb1",attrs:{type:"text",name:"expYear",placeholder:"Exp Year"},domProps:{value:t.expYear},on:{input:function(e){e.target.composing||(t.expYear=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.ccv,expression:"ccv"}],staticClass:"db mb1",attrs:{type:"text",name:"ccv",placeholder:"Security Code (CCV)"},domProps:{value:t.ccv},on:{input:function(e){e.target.composing||(t.ccv=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.billingPostalZipcode,expression:"billingPostalZipcode"}],staticClass:"db mb1",attrs:{type:"text",name:"billingPostalZipcode",placeholder:"Billing Postal/Zip Code"},domProps:{value:t.billingPostalZipcode},on:{input:function(e){e.target.composing||(t.billingPostalZipcode=e.target.value)}}}),n("p",[t._v("\n     Subtotal: "+t._s(t.checkout.live.total_due.formatted_with_code)+"\n    ")]),n("p",[t._v("\n     Shipping: "+t._s(t.selectedShippingPrice)+"\n    ")]),n("button",{staticClass:"dim b1 outline-0 pointer pa2 mt2 db w-100 ttc",class:[t.shippingOptions.length?"b--mid-gray":"b--light-gray"],attrs:{disabled:!t.shippingOptions.length}},[t._v("\n      complete order\n    ")])]),n("span",{staticClass:"db tracked ttu tc mv2"},[t._v("or")]),n("button",{staticClass:"dim b1  b--mid-gray outline-0 pointer pa2 mt2 db w-100 ttc",on:{click:function(e){return t.$emit("cancel-checkout")}}},[t._v("\n    continue shopping\n  ")])])},j=[],S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cart-container__line-item w-100 flex items-center justify-between pb2"},[n("div",{staticClass:"w-auto pr1"},[n("p",{staticClass:"tracked ttc f7"},[t._v("\n      "+t._s(t.item.product_name)+" - ("+t._s(t.item.quantity)+")\n    ")])]),n("p",{staticClass:"pa0 ma0"},[t._v("\n    $"+t._s(t.item.line_total.formatted_with_code)+"\n  ")])])},E=[],A={name:"CheckoutItem",props:["item"]},F=A,Z=Object(d["a"])(F,S,E,!1,null,null,null),$=Z.exports,R={name:"Checkout",components:{CheckoutItem:$},data:function(){return{customerFirstName:"",customerLastName:"",customerEmail:"",country:"US",shippingFullName:"",streetAddress:"",city:"",provinceRegionState:"",postalZipcode:"",shippingOption:"",shippingOptions:[],shippingOptionsById:{},cardNumber:"4242 4242 4242 4242",expMonth:"01",expYear:"2021",ccv:"123",billingPostalZipcode:"32825",countries:{},subdivisions:{}}},props:["commerce","checkout"],created:function(){this.getAllCountries(),this.getRegions(this.country),this.getShippingOptions(this.checkout.id,this.country)},watch:{country:function(t,e){t!==e&&(this.getRegions(t),this.getShippingOptions(this.checkout.id,t))}},methods:{getAllCountries:function(){var t=this;this.commerce.Services.localeListShippingCountries(this.checkout.id,function(e){t.countries=e.countries},function(t){return console.log(t)})},getRegions:function(t){var e=this;this.commerce.Services.localeListSubdivisions(t,function(t){e.subdivisions=t.subdivisions},function(t){return console.log(t)})},getShippingOptions:function(t,e){var n=this;this.commerce.Checkout.getShippingOptions(t,{country:e},function(t){t.error?(n.shippingOptions=[],n.shippingOptionsById={}):(n.shippingOptions=t,n.shippingOptionsById=t.reduce(function(t,e){return t[e.id]=e,t},{}))})},captureOrder:function(){var t=this.checkout.live.line_items.reduce(function(t,e){return t[e.id]={quantity:e.quantity},t},{}),e={line_items:t,customer:{firstname:this.customerFirstName,lastname:this.customerLastName,email:this.customerEmail},shipping:{name:this.shippingFullName,country:this.country,street:this.streetAddress,town_city:this.city,county_state:this.provinceRegionState,postal_zip_code:this.postalZipcode},fulfillment:{shipping_method:this.shippingOption},payment:{gateway:"test_gateway",card:{number:this.cardNumber,expiry_month:this.expMonth,expiry_year:this.expYear,cvc:this.ccv,postal_zip_code:this.billingPostalZipcode}}};this.$emit("capture-order",this.checkout.id,e)}},computed:{selectedShippingPrice:function(){return this.shippingOptionsById[this.shippingOption]&&this.shippingOptionsById[this.shippingOption].price.formatted_with_code||"----"}}},I=R,L=Object(d["a"])(I,N,j,!1,null,null,null),M=L.exports,T=(n("f24d"),function(t,e){var n={};return t.reduce(function(t,n){return Object(s["a"])({},t,Object(a["a"])({},n[e],n))},n)}),Y=function(t){return t.line_items.flatMap(function(t){return Array(t.quantity).fill(t.product_id)})},q={name:"app",components:{ProductItem:h,Cart:O,Checkout:M},props:{commerce:{required:!0,type:Object}},created:function(){if(void 0!==this.commerce&&"undefined"!==typeof this.commerce){var t=this;this.commerce.Products.list(function(e){function n(){return["prod_0egY5eaDj53QnA","prod_bWZ3l8m81wkpEQ","prod_DWy4oGD3q56Jx2"]}function i(t){return t}function r(e){var n=T(t.products,"id");t.recProducts=e.map(function(t){return n[t]})}t.products=e.data,bandit.getDecision("bandit-provided-exp-id",n,i,r)},function(t){console.log(t)}),window.addEventListener("Commercejs.Cart.Ready",function(){var t=this;this.commerce.Cart.retrieve(function(e){e.error||(t.cart=e)})}.bind(this))}},methods:{addProductToCart:function(t){var e=this;this.commerce.Cart.add({id:t},function(t){t.error||(e.cart=t.cart,bandit.updateContextValue({itemsInCart:Y(e.cart)}))})},removeProductFromCart:function(t){var e=this;this.commerce.Cart.remove(t,function(t){t.error||(e.cart=t.cart),bandit.updateContextValue({itemsInCart:Y(e.cart)})})},refreshCart:function(){this.commerce.Cart.refresh(function(t){},function(t){return console.log(t)})},createCheckout:function(){var t=this;this.cart.total_items>0&&this.commerce.Checkout.generateToken(this.cart.id,{type:"cart"},function(e){t.checkout=e},function(t){console.log("Error:",t)})},cancelCheckout:function(){this.checkout=null},captureOrder:function(t,e){var n=this;console.log(arguments),this.commerce.Checkout.capture(t,e,function(t){n.refreshCart(),n.checkout=null,n.order=t},function(t){return console.log(t)})}},data:function(){return{products:[],recProducts:[],cart:null,checkout:null,order:null}}},B=q,D=Object(d["a"])(B,r,o,!1,null,null,null),z=D.exports,J=new window.Commerce("pk_test_1551355ddcd1fde4b5d32b066305d6c6a172eea886ae6",!1);i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(z,{props:{commerce:J}})}}).$mount("#app")},f24d:function(t,e,n){}});
//# sourceMappingURL=app.0db576b9.js.map